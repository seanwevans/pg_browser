-- Attempt to reload a non-existent session; should raise an error
DO $$
BEGIN
    BEGIN
        PERFORM pgb_session.reload(gen_random_uuid());
        RAISE EXCEPTION 'reload did not fail';
    EXCEPTION
        WHEN sqlstate 'PGBSN' THEN
            RAISE NOTICE 'error raised as expected';
        WHEN others THEN
            RAISE EXCEPTION 'unexpected error: %', SQLERRM;
    END;
END;
$$;
NOTICE:  error raised as expected
